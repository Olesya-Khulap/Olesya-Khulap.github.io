!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=372)}({372:function(e,t,n){n(373)},373:function(e,t){dl_documentReady(function(){"use strict";M.define("docTrans_tools",["U","$"],function(e,t){return{initFileDrop:function(n,a){var o=!1,r="[initFileDrop]",s=t(n);setTimeout(function(){var t,n=s.closest("[_dl-dragging-root]"),i=!1;function u(e){var n=e.originalEvent.dataTransfer;if(n)if(!n.types||Array.from(n.types).indexOf("Files")<0)o&&console.log(r,"(dbg) Dragging non-file:",n.types);else{e.originalEvent.dataTransfer.dropEffect="none";var a=[];if(n.items&&n.items.length)for(var s=0;s<n.items.length;++s)a.push(n.items[s].type);else a.push(void 0);var i=e.originalEvent,u=i.target;t.onDragOver(u,a,i),e.preventDefault(),e.stopPropagation(),clearTimeout(t.cleanupTimerId),t.cleanupTimerId=setTimeout(t.onStopDragging,500)}else console.log(r,"old browser; limited draggin support")}n.length?o&&console.log(r,"re-use dragging root"):(n=s.attr("_dl-dragging-root",!0),o&&console.log(r,"create new dragging root"),t={cleanupTimerId:0,onDragOver:e.createMultiProcedure(),onStopDragging:e.createMultiProcedure(),onDrop:e.createMultiProcedure()},n.data("_dl_dragging_data",t).on("dragleave",function(e){u(e)}).on("dragenter",function(e){u(e)}).on("dragover",function(e){u(e)}).on("drop",function(n){o&&console.log(r,"Drop Event",n.originalEvent),i=!1;var a=n.originalEvent.dataTransfer&&n.originalEvent.dataTransfer.files;if(a&&a.length){var s=e.value(!1);n.originalEvent.dataTransfer&&(n.originalEvent.dataTransfer.dropEffect="none");for(var u=n.originalEvent.target;u&&!s();u=u.parentNode)t.onDrop(s,u,n.originalEvent,a);s()&&(n.preventDefault(),n.stopPropagation())}}).on("mouseleave",function(e){clearTimeout(t.cleanupTimerId),t.onStopDragging()})),o&&console.log(r,"init",s[0]),(t=n.data("_dl_dragging_data")).onDragOver.push(function(e,t,n){if(!s.closest("body").length)return o&&console.log(r,"remove 1"),"REMOVE";for(var u=!1,c=s[0],l=e;l;l=l.parentNode)l===c&&(u=!0);!i&&u?(i=!0,o&&console.log(r,"DRAGGING START",t,c),a("dragstart",t)):i&&!u&&(i=!1,o&&console.log(r,"DRAGGING END"),a("dragend",void 0)),u&&a("dragging",t,n)}),t.onStopDragging.push(function(){if(!s.closest("body").length)return"REMOVE";i&&(i=!1,o&&console.log(r,"DRAGGING END"),a("dragend",void 0))}),t.onDrop.push(function(e,t,n,i){if(!s.closest("body").length)return o&&console.log(r,"remove node"),"REMOVE";s[0]!==t||e()||(e(!0),o&&console.log(r,"Drop Event handled",s[0]),a("drop",i,n))})})},htmlEscape:function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}}),M.define("docTrans_Document",["U"],function(e){function t(t){var n=this;n.id=t,n.remoteId=e.value(),n.remoteKey=e.value(),n.sourceName=e.value(),n.targetName=e.value(),n.fileType=e.value(),n.fileObject=e.value(),n.fileSize=e.value(),n.uploadTimestamp=e.value(),n.translationNotes=e.value(),n.fileCharacterCount=e.value(),n.billableCharacterCount=e.value(),n.totalTime=e.value(),n.remainingTime=e.value(),n.status=e.value(),n.shouldShowLimitNearMessage=e.value(),n.errorId=e.value(),n.errorMessage=e.value(),n.errorDetails=e.value(),n.downloadUrl=e.value(),n.sourceLang=e.value(),n.targetLangAndVariant=e.value(),n.alreadyDownloaded=e.value(!1),n.getTargetLang=function(){return n.targetLangAndVariant()&&n.targetLangAndVariant().substr(0,2)}}return t.STATUS__UNDEFINED=void 0,t.STATUS__WAITING_FOR_TARGET_LANG="waiting_for_target_lang",t.STATUS__UPLOADING="uploading",t.STATUS__WAITING="queued",t.STATUS__TRANSLATING="translating",t.STATUS__READY="done",t.STATUS__DELETED="deleted",t.STATUS__ERROR="error",t}),M.define("docTrans_base",["U","RPC","dlPageState","docTrans_Document","docTrans_config"],function(e,t,n,a,o){var r=e.urlWithParameters(o.backendUrl,{request_type:"jsonrpc",il:n.il}),s=t.connectTo({url:r,method:"POST",timeout:1e4,withCredentials:!0}),i=[".docx",".pptx"],u="\\.(docx|pptx",c=["application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation"];n.pro&&(i.push(".txt"),u+="|txt",c.push("text/plain")),o.enableHtmlDocTrans&&(i.push(".htm"),i.push(".html"),u+="|htm|html",c.push("text/html"));var l={DOC_TRANS_BACKEND_URL:r,ACCEPTED_FILE_TYPES:i,ACCEPTED_FILE_REGEX:new RegExp(u+")$","i"),ACCEPTED_MIME_TYPES:c,rpc_getDocumentsStatus:s.getFunction("getDocumentsStatus"),rpc_sendFeedback:s.getFunction("sendFeedback"),rpc_translateAgain:s.getFunction("translateAgain"),rpc_removeDocuments:s.getFunction("removeDocuments"),createDocumentTargetFilename:function(e){return(e.sourceName()||"document").replace(/ (DE|EN|FR|ES|PL|PT|IT|NL|RU|PT)(\.[^.]+)$/,"$2").replace(/(\.[^.]+)$/," "+e.getTargetLang()+"$1")},createDownloadLink:function(t){return e.urlWithParameters(l.DOC_TRANS_BACKEND_URL,{dl:1,id:t.remoteId(),key:t.remoteKey(),name:t.targetName()||l.createDocumentTargetFilename(t)})},createDocument:function(){var e=new a("doc_"+Date.now());return e.status(a.STATUS__UNDEFINED),e},createDocumentForFileObject:function(e){if(!e.name.match(l.ACCEPTED_FILE_REGEX))throw console.log(e.name,l.ACCEPTED_FILE_REGEX),new Error("error.invalidFileType");var t=l.createDocument();return t.sourceName(e.name),t.fileType(e.name.match(/\.([^.]+)$/)[1].toLowerCase()),t.fileSize(e.size),t.fileObject(e),t}};return l}),M.define("docTrans_controller",["U","docTrans_base","docTrans_Document","$","dlPageState","docTrans_config","docTrans_texts","dlStats"],function(e,t,n,a,o,r,s,i){var u="[docTrans_controller]",c=!1,l=e.createMultiProcedure(),d=e.createMultiProcedure(),g={};function _(e){return g[e]}function T(){return Object.values(g)}var m=e.createCallOnce();function p(){c&&console.log(u,"Plan refresh"),m();var e,a=(e=[],T().forEach(function(t){var a=t.status();a===n.STATUS__UNDEFINED||a===n.STATUS__WAITING||a===n.STATUS__TRANSLATING||a===n.STATUS__READY||a===n.STATUS__UPLOADING&&t.uploadTimestamp()?e.push({key:t.remoteKey(),id:t.remoteId()}):a!==n.STATUS__DELETED&&a!==n.STATUS__UPLOADING&&console.warn(u,"invalid status",a)}),0!==e.length&&new Promise(function(a,o){t.rpc_getDocumentsStatus({documents:e}).then(function(e){var o=g;e.documents.forEach(function(e){var a=e.id,r=Object.values(o).find(function(e){return e.remoteId()===a});r?(void 0!==e.seconds_remaining&&(r.remainingTime(e.seconds_remaining),r.totalTime()||r.totalTime(e.seconds_remaining)),void 0!==e.notes&&r.translationNotes(Array.isArray(e.notes)?e.notes:[]),void 0!==e.chars&&r.fileCharacterCount(e.chars),void 0!==e.billable_chars&&r.billableCharacterCount(e.billable_chars),e.limit_near&&r.shouldShowLimitNearMessage(!0),"processing"===e.status||"translating"===e.status?r.status(n.STATUS__TRANSLATING):"queued"===e.status?r.status(n.STATUS__WAITING):"error"===e.status?(e.error_details&&(r.errorDetails(e.error_details),r.errorMessage(e.error_details)),r.status(n.STATUS__ERROR)):"deleted"===e.status?r.status(n.STATUS__DELETED):"done"===e.status?r.status()!==n.STATUS__READY&&(r.remainingTime(0),r.downloadUrl(t.createDownloadLink(r)),setTimeout(function(){r.status(n.STATUS__READY),d(r)},1e3)):(r.status(n.STATUS__UNDEFINED),console.warn(u,"Unkown document status",e.status))):console.warn(u,"Unkown document",e)}),a()},o)}));a&&a.then(function(){m();var e=[];if(T().forEach(function(t){var a=t.status();if(a===n.STATUS__UNDEFINED)e.push(document.hidden?30:5);else if(a===n.STATUS__WAITING)e.push(document.hidden?60:20);else if(a===n.STATUS__TRANSLATING){var o=t.remainingTime()||0;document.hidden?e.push(60):o>180?e.push(30):e.push(10)}else a===n.STATUS__READY&&e.push((document.hidden,60))}),e.length){var t=Math.min.apply(Math,e);c&&console.log(u,"Scheduling refresh in ",t,"seconds");var a=setTimeout(p,1e3*t);m.push(function(){clearTimeout(a)})}else c&&console.log(u,"No update necessary ")},function(e){console.warn(u,"planRefresh",e),m();var t=setTimeout(function(){console.log(u,"Refresh after error"),document.hidden||p()},2e4);m.push(function(){clearTimeout(t)})})}a(document).on("visibilitychange",function(){p(),c&&console.log(u,"Visibility change")});var f=e.value(window.localStorage&&window.localStorage.getItem("docTrans.preferredTargetLang")||window.LMT_WebTranslator_Instance.getSelectedTargetLang());return f.onValueChanged.push(function(e){c&&console.log(u,"new preferred target lang"),window.localStorage&&window.localStorage.setItem("docTrans.preferredTargetLang",e)}),{_planRefresh:p,uploadFile:function(a,l){var g=l.cancelUploadHook,_=l.autoDownload;return new Promise(function(l,T){a.targetName(t.createDocumentTargetFilename(a)),a.status(n.STATUS__UPLOADING);var m=new FormData;m.append("data",a.fileObject(),a.sourceName()),c&&console.log(u,"Start uploading file ",a.fileObject());var f=(a.fileObject().size||0)/1048576,v=a.sourceName().replace(/^.*\.([^.]+)$/,"$1").toLowerCase();if("docx"===v&&f>r.fileSize_proDOCX)return a.errorMessage(s["docTrans/error.too_large_pro"].replace("${size}",r.fileSize_proDOCX)),a.status(n.STATUS__ERROR),void T();if("pptx"===v&&f>r.fileSize_proPPTX)return a.errorMessage(s["docTrans/error.too_large_pro"].replace("${size}",r.fileSize_proPPTX)),a.status(n.STATUS__ERROR),void T();if("txt"===v&&f>r.fileSize_proTXT)return a.errorMessage(s["docTrans/error.too_large_pro"].replace("${size}",r.fileSize_proTXT)),a.status(n.STATUS__ERROR),void T();if(r.enableHtmlDocTrans&&("htm"===v||"html"===v)&&f>r.fileSize_proHTML)return a.errorMessage(s["docTrans/error.too_large_pro"].replace("${size}",r.fileSize_proHTML)),a.status(n.STATUS__ERROR),void T();if(!o.pro&&"docx"===v&&f>r.fileSize_freeDOCX)return a.errorMessage(s["docTrans/error.too_large_free"]),a.status(n.STATUS__ERROR),void T();if(!o.pro&&"pptx"===v&&f>r.fileSize_freePPTX)return a.errorMessage(s["docTrans/error.too_large_free"]),a.status(n.STATUS__ERROR),void T();_&&d.push(function(e){if(e.id==a.id){var t=a.downloadUrl();return a.alreadyDownloaded(!0),setTimeout(function(){console.log(u,"Downloading document",t),location.href=t}),"REMOVE"}});var S=new XMLHttpRequest;S.open("POST",e.urlWithParameters(t.DOC_TRANS_BACKEND_URL,{source_lang:a.sourceLang(),target_lang:a.targetLangAndVariant().toUpperCase()}),!0),S.withCredentials=!0,S.onerror=function(e){console.warn(u,"STATUS",S.status),console.warn(u,"Upload failed: Can't connect to server. Please try again later.",e),a.errorMessage("upload_noConnection"),a.status(n.STATUS__ERROR),T()},S.onload=function(){if(200===S.status){var e;try{e=JSON.parse(S.responseText)}catch(e){return console.warn("Parsing error ["+S.responseText+"] (a)"),a.errorMessage("upload_noConnection"),a.status(n.STATUS__ERROR),void T()}var t=e.result;!function(e){if(i.countStats("i",function(e){return e+1},0),i.countEvent("document_translated",1),void 0!==e.timestamp&&(i.countStats("j",function(t){return 0==t?e.timestamp:t},0),i.countStats("k",function(t){return e.timestamp},0)),void 0!==e.date){var t=i.getStats("l","");t()!=e.date&&(t(e.date),i.countEvent("document_translated_day",1),i.countStats("m",function(e){return e+1},0))}}(t);var o=t&&t.id,r=t&&t.key;o&&r?(c&&console.log(u,"Upload done!",S),setTimeout(function(){a.remoteId(t.id),a.remoteKey(t.key),a.uploadTimestamp(Date.now()),setTimeout(p,1e3),l(a)},100)):(console.warn(u,"Upload failed: Remote error:",e),e.error?(a.errorMessage(e.error.message||"upload_fileNotAccepted"),a.errorId(e.error.code)):a.errorMessage("upload_fileNotAccepted"),a.status(n.STATUS__ERROR),T())}else if(413===S.status)console.warn(u,"Upload failed: File too large ",S),a.errorMessage("too_large"),a.status(n.STATUS__ERROR),T();else{var s;console.warn(u,"Upload failed: ",S,S.responseText);try{s=JSON.parse(S.responseText)}catch(e){return console.warn("Parsing error ["+S.responseText+"] (b)"),a.errorMessage("upload_noConnection"),a.status(n.STATUS__ERROR),void T()}s.error?a.errorMessage(s.error.message||"upload_fileNotAccepted"):a.errorMessage("upload_fileNotAccepted"),a.status(n.STATUS__ERROR),T()}S=void 0},g&&g.push(function(){S&&S.abort(),S=void 0}),S.send(m)})},retryWithUpdatedLanguage:function(e,a){e.errorMessage(void 0),e.errorDetails(void 0),e.targetLangAndVariant(a.toUpperCase()),e.targetName(t.createDocumentTargetFilename(e)),e.status(n.STATUS__TRANSLATING),t.rpc_translateAgain({id:e.remoteId(),key:e.remoteKey(),target_lang:e.targetLangAndVariant()}).then(function(){console.log(u,"Translation re-started"),setTimeout(p,500)},function(t){e.errorMessage(t.message),e.errorDetails(t.message),e.status(n.STATUS__ERROR),console.error(t)})},getDocuments:T,getDocument:_,onDocumentsChanged:l,onDocumentReady:d,removeDocument:function(e){var a=_(e);a&&(a.status()!==n.STATUS__DELETED&&a.remoteId()&&t.rpc_removeDocuments({documents:[{id:a.remoteId(),key:a.remoteKey()}]}),delete g[e],l(T()))},registerDocument:function(e){g[e.id]||(g[e.id]=e,l(T()))},clearDocuments:function(){Object.keys(g).forEach(function(e){delete g[e]}),l(T())},preferredTargetLang:f}}),M.define("docTrans_UI",["$","U","dlPageState","H2","docTrans_controller","docTrans_texts","docTrans_base","docTrans_tools","docTrans_Document","docTrans_usageController","docTrans_usageView"],function(e,t,n,a,o,r,s,i,u,c,l){var d,g="[docTrans_UI]",_=!1,T=t.createCallOnce(),m={AUTO:r["translator/anyLanguage"],EN:r["translator/selectLang.target.en"],"en-US":r["translator/selectLang.target.en.en-US"],"en-GB":r["translator/selectLang.target.en.en-GB"],DE:r["translator/selectLang.target.de"],FR:r["translator/selectLang.target.fr"],ES:r["translator/selectLang.target.es"],IT:r["translator/selectLang.target.it"],NL:r["translator/selectLang.target.nl"],PL:r["translator/selectLang.target.pl"],RU:r["translator/selectLang.target.ru"],PT:r["translator/selectLang.target.pt"],"pt-PT":r["translator/selectLang.target.pt.pt-PT"],"pt-BR":r["translator/selectLang.target.pt.pt-BR"]},p=[];function f(){var e,n=t.value(!0),o=c.getData().accountType();e="teamMember"===o?"docTrans_quota_exceeded_popup--team_member":"enterprise"===o?"docTrans_quota_exceeded_popup--enterprise_user":"docTrans_quota_exceeded_popup",a.createTemplateContainer({type:e,teamName:c.getData().teamName(),isOpen:n,isRemoved:t.computedValue(n,function(e){return!e}),doClose:function(){n(!1)},doSubmit:function(){console.log("Go to account page..."),n(!1),location.href="/pro-account.html?page=category_plan"},period:c.getData().period}).appendTo("body"),console.log(c.getData())}function v(e){S.keepActive(S.keepActive()+1),setTimeout(function(){S.keepActive(S.keepActive()-1)},e||1e3)}["EN","DE","FR","ES","PT","IT","NL","PL","RU"].forEach(function(e){"EN"===e&&n.hasFeatureFlag("regionalTargetLangs_EN_2020_03")?p.push("en-US","en-GB"):"PT"===e&&n.hasFeatureFlag("regionalTargetLangs_PT_2020_03")?p.push("pt-PT","pt-BR"):p.push(e)});var S={panelContent:t.value(void 0),infoContent:t.value(void 0),selectedFileList:t.value(void 0),acceptedFileTypes:s.ACCEPTED_FILE_TYPES.join(","),selectedTargetLang:t.value(void 0),targetLangText:t.value("???"),targetLangMenu:t.value(void 0),langMenuEntries:t.value(void 0),dropTargetOverlay:t.value(void 0),withOpenedTargetLangMenu:t.value(!1),keepActive:t.value(0),translationAllowed:t.computedValue([c.isTranslationAllowed],function(e){return!e}),doSelectFile:function(){S.selectedFileList(void 0),n.pro?c.isTranslationAllowed()?d.click():f():d.click()},doInitButton:function(e){if(n.pro){var t=0;e.addEventListener("mouseenter",function(e){clearTimeout(t),t=setTimeout(function(){M.requireAsync(["docTrans_usageView"],function(e){e.showAfterLazyRefesh(60,.5)})},500)}),e.addEventListener("mouseleave",function(e){clearTimeout(t),t=setTimeout(function(){M.requireAsync(["docTrans_usageView"],function(e){e.hideTemp()})},3e3)})}},doRegisterFileInput:function(e){d=e},doCloseLangMenu:function(){S.withOpenedTargetLangMenu()&&(S.withOpenedTargetLangMenu(!1),v(1500))},doToggleTargetLangMenu:function(){S.withOpenedTargetLangMenu(!S.withOpenedTargetLangMenu()),v(1e3)}};S.selectedTargetLang.onValueChanged.push(function(e){S.targetLangText(r["docTrans/translator.uploadButton_2"].replace("${translateIntoLang}",m[e])),S.langMenuEntries(p.map(function(e){return{type:"docTrans_upload_button__target_lang_menu_entry",langName:m[e],selectLangTrigger:function(){o.preferredTargetLang(e),S.doCloseLangMenu(!1)}}}))}),S.selectedTargetLang(o.preferredTargetLang()),o.preferredTargetLang.onValueChanged.push(S.selectedTargetLang),S.targetLangMenu({type:"docTrans_upload_button__target_lang_menu",entries:S.langMenuEntries}),t.withValue([S.selectedFileList],function(e){if(e&&e.length){console.log("File selected",e);var t=e[0],n=s.createDocumentForFileObject(t);n.status(u.STATUS__WAITING_FOR_TARGET_LANG),o.registerDocument(n)}});var h=t.createCallOnce(),D=t.createCallOnce();S.panelContent.onValueChanged.push(function(t){t?e(".lmt").addClass("lmt--hidden"):(e(".lmt").removeClass("lmt--hidden"),h())});var E={};o.onDocumentsChanged.push(function a(){var d=o.getDocuments();_&&console.log(g,"refreshDocumentUI: ",d);var v=[];d.forEach(function(d){E[d.id]||(d.status.onValueChanged.push(a),E[d.id]=!0);var S=function(e){var a,d=e.fileType(),v=function(){T(),o.removeDocument(e.id),_&&console.log(g,"Continue!",e.id),l&&l.hide(),D()},S=e.status();if(!c.isTranslationAllowed())return T(),o.removeDocument(e.id),f(),!1;if(S===u.STATUS__UPLOADING)a={type:"docTrans_document__target--uploading",statusText:r["docTrans/document.status_uploading"],doCancel:v};else if(S===u.STATUS__WAITING||e.status()===u.STATUS__TRANSLATING){n.pro&&l.showAfterLazyRefesh(15,1);var h=t.value("");setTimeout(function(){h(" "+r["docTrans/document.bePatient"])},3e4),a={type:"docTrans_document__target--working",statusText:r["docTrans/document.status_translating"].replace("${translateIntoLang}",r["docTrans/translateIntoLang."+e.getTargetLang().toLowerCase()]),remainingTimeText:h,doCancel:v}}else if(S===u.STATUS__READY)n.pro?(e.alreadyDownloaded.onValueChanged.push(function(){setTimeout(function(){console.log("[DocTrans] Refresh usage data..."),c.refreshData(!0)},500)}),a={type:"docTrans_document__target--ready_pro",statusText:r["docTrans/documentReady.translationReady"].replace("${translation}",r["docTrans/translation."+e.getTargetLang().toLowerCase()]).replace("${documentName}",i.htmlEscape(e.sourceName())),downloadURL:e.downloadUrl(),targetName:e.targetName(),docNotes:(e.translationNotes()||[]).map(function(e){return{type:"docTrans_document__doc_warning",text:r["docTrans/"+e]||e}}),additionalHints:e.shouldShowLimitNearMessage()?{type:"docTrans_document_ready__limit_near_hint"}:void 0,alreadyDownloaded:e.alreadyDownloaded,feedback_open:t.value(!1),feedback_description:t.value(""),feedback_feedbackSent:t.value(!1),doSendFeedback:function(){_&&console.log(g,"Send feedback:",e.remoteId(),e.remoteKey(),a.feedback_description()),a.feedback_feedbackSent(!0),s.rpc_sendFeedback({id:e.remoteId(),key:e.remoteKey(),feedback:a.feedback_description(),use_document_consent:!1})},doContinue:function(){v()}}):a={type:"docTrans_document__target--ready",statusText:r["docTrans/documentReady.translationDownloaded"].replace("${translation}",r["docTrans/translation."+e.getTargetLang().toLowerCase()]).replace("${documentName}",i.htmlEscape(e.sourceName())),downloadURL:e.downloadUrl(),targetName:e.targetName(),docNotes:(e.translationNotes()||[]).map(function(e){return{type:"docTrans_document__doc_warning",text:r["docTrans/"+e]||e}}),doContinue:v};else if(S===u.STATUS__WAITING_FOR_TARGET_LANG)n.pro&&l.showAfterLazyRefesh(30,1),a={type:"docTrans_document__target_lang_select",targetLang:function(t){e.sourceLang("auto"),e.targetLangAndVariant(t),o.uploadFile(e,{cancelUploadHook:T,autoDownload:!n.pro}).then(function(){},function(e){console.warn(g,"Error while uploading",e)})},doCancel:v};else if(S===u.STATUS__ERROR)if("languages_equal"===e.errorDetails()){var E=e.getTargetLang(),y=[];p.forEach(function(t){t!==E&&y.push({type:"docTrans_document__choose_different_target_lang_target__entry",langName:m[t],doExecute:function(){o.retryWithUpdatedLanguage(e,t.toLowerCase())}})}),a={type:"docTrans_document__choose_different_target_lang_target",statusText:r["docTrans/document.chooseDifferentLangHint"].replace("${detectedLangName}",r["docTrans/detectedLangName."+E.toLowerCase()]),languages:y,doCancel:v}}else a="language_not_supported"===e.errorDetails()?{type:"docTrans_document__target--error",statusText:r["docTrans/document.status_error"],errorText:r["docTrans/error.unsupported_source_language"],doContinue:v}:{type:"docTrans_document__target--error",statusText:r["docTrans/document.status_error"],errorText:r["docTrans/error."+e.errorMessage()]||e.errorMessage()||"",doContinue:v};else S===u.STATUS__DELETED?a={type:"docTrans_document__target--error",statusText:r["docTrans/document.status_deleted"],doContinue:v}:(a={type:"docTrans_document__target--error",statusText:"Unknown status:"+S,doContinue:v},console.warn("Unknown status"));return{type:"docTrans_document",sourceName:e.sourceName(),fileType:d,target:a}}(d);S&&v.push(S),d.status()===u.STATUS__READY&&(_&&console.log(g,"Set document ready style"),e("body").addClass("docTrans_body--with_ready_doc"),h.push(function(){e("body").removeClass("docTrans_body--with_ready_doc")}))}),S.panelContent(!!v.length&&{type:"docTrans_container",documents:v})}),e("body").addClass("docTrans_body");var y=t.value(!1);function A(e){return 0===e.length||1===e.length&&(""===e[0]||void 0===e[0]||s.ACCEPTED_MIME_TYPES.indexOf(e[0])>=0)}i.initFileDrop("body",function(t,n,a){"dragstart"===t&&-1===window.location.href.indexOf("beta.deepl.com")?A(n)?(S.dropTargetOverlay({type:"docTrans_drop_target_overlay",hoverDropArea:y,initDropTarget:function(e){_&&console.log(g,"INIT",e),i.initFileDrop(e,function(e,t,n){if(y("dragstart"===e||"dragging"===e),"drop"===e){S.dropTargetOverlay(void 0);var a=t;if(1==a.length&&a[0].name.match(s.ACCEPTED_FILE_REGEX)){var r=a[0],i=s.createDocumentForFileObject(r);i.status(u.STATUS__WAITING_FOR_TARGET_LANG),o.registerDocument(i),n.dataTransfer.dropEffect="copy"}else console.warn(g,"Invalid files dropped",a),n.dataTransfer.dropEffect="none"}else"dragging"===e&&(n.dataTransfer.dropEffect=A(t)?"copy":"none")})}}),e(".lmt__sides_container").addClass("lmt__sides_container--docTrans_overlay"),D.push(function(){return e(".lmt__sides_container").removeClass("lmt__sides_container--docTrans_overlay")})):(S.dropTargetOverlay({type:"docTrans_drop_target_overlay_failure"}),e(".lmt__sides_container").addClass("lmt__sides_container--docTrans_overlay_failure"),D.push(function(){return e(".lmt__sides_container").removeClass("lmt__sides_container--docTrans_overlay_failure")})):"dragstart"===t&&-1!==window.location.href.indexOf("beta.deepl.com")?(S.dropTargetOverlay({type:"docTrans_drop_target_overlay_not_available_beta"}),e(".lmt__sides_container").addClass("lmt__sides_container--docTrans_overlay_failure"),D.push(function(){return e(".lmt__sides_container").removeClass("lmt__sides_container--docTrans_overlay_failure")})):"dragend"!==t&&"drop"!==t||(S.dropTargetOverlay(void 0),D())}),a.connectNodesToValues("body",{docTrans:S})}),M.define("docTrans_usageController",["dlRPC","U","dlPageState"],function(e,t,n){var a,o,r=0;function s(){return a||((a=t.createValues({accountType:void 0,period:void 0,supportsDocuments:void 0,userDocumentCount:void 0,userDocumentLimit:void 0,teamDocumentCount:void 0,teamDocumentLimit:void 0,teamName:void 0,isUsageBased:void 0,status_busy:!1,status_ready:!1,status_dlError:void 0})).userQuotaReached=t.computedValue([a.accountType,a.userDocumentCount,a.userDocumentLimit,a.teamDocumentLimit],function(e,t,n,a){return"single"===e?t>=a:"teamMember"===e&&t>=n}),a.teamQuotaReached=t.computedValue([a.teamDocumentCount,a.teamDocumentLimit],function(e,t){return e>=t})),a}n.pro&&(o=t.persistentValue("docTrans.checkBudget",!1,172800))()&&(console.log("docTrans_usageController: checkBudget"),setTimeout(u,1e3));var i=t.value(!0);function u(t){var a=s();return t&&a.status_busy(!1),new Promise(function(t,s){a.status_busy()||(a.status_busy(!0),e.getBackend("/PHP/backend/docTrans.php").callFunction("getDocumentConsumptionInfo").then(function(e){r=Date.now(),a.status_dlError(void 0),a.accountType(e.accountType),a.period((e.period||"").replace("&mdash;","—")),a.isUsageBased(e.isUsageBased),a.userDocumentCount(e.userDocumentCount),a.userDocumentLimit(e.userDocumentLimit),a.teamDocumentCount(e.teamDocumentCount),a.teamDocumentLimit(e.teamDocumentLimit),a.teamName(e.teamName),a.status_busy(!1),i(!n.pro||!a.userQuotaReached()&&!a.teamQuotaReached()),o(!i()),a.status_ready(!0),t()},function(t){r=Date.now(),a.status_busy(!1);var n=e.rpcError_to_dlError(t);a.status_dlError(n),s(n)}))})}return{getData:function(){return s()},isDataAvailable:function(){return!(!a||!a.status_ready())},refreshData:u,lazyRefresh:function(e){return r<Date.now()-1e3*e?u():new Promise(function(e,t){e(s())})},isTranslationAllowed:i}}),M.define("docTrans_usageView",["dlRPC","U","H2","docTrans_usageController"],function(e,t,n,a){var o,r=t.value(0);return{showAfterLazyRefesh:function(e,s){o||function(){var e=a.getData();o={type:"docTrans_usage_info",period:e.period,userDocuments:t.computedValue([e.accountType,e.userDocumentCount,e.userDocumentLimit,e.teamDocumentLimit],function(e,t,n,a){return"single"===e?t+" / "+a:"teamMember"===e&&n<a?t+" / "+n:t}),teamDocuments:t.computedValue([e.accountType,e.teamDocumentCount,e.teamDocumentLimit],function(e,t,n){return"single"!==e&&"enterprise"!==e&&t+" / "+n}),status_busy:e.status_busy,userQuotaReached:e.userQuotaReached,teamQuotaReached:e.teamQuotaReached};var s=t.computedValue([r,e.accountType,e.isUsageBased,e.status_ready,e.userDocumentCount,e.teamDocumentCount],function(e,t,n,a,r,s){return"enterprise"!==t&&!!(e>0&&!n&&a&&(r>0||s>0))&&o});n.connectNodesToValues("body",{docTransUsage:{content:s}})}(),a.isDataAvailable()&&a.getData().isUsageBased()||a.lazyRefresh(e).then(function(){r(Math.max(r(),s||1))})},hide:function(){r(0)},hideTemp:function(){r(Math.floor(r()))}}})})}});